{% load static %}
<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>首页</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <link rel="stylesheet" href="{% static 'css/main.css' %}">
  <link rel="stylesheet" href="{% static 'css/edit-modal.css' %}">
  <link rel="stylesheet" href="{% static 'css/target-groups.css' %}">
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css">
</head>
<body>
  <header class="top-bar">
    <div class="user-info">
      <span>当前用户: {{ user.username }}</span>
      <a href="{% url 'logout' %}" class="logout-btn">退出登录</a>
    </div>
  </header>

  <div class="container">
    <!-- 左侧菜单栏 -->
    <div class="sidebar">
      <h2>网络运维服务</h2>
      <ul class="menu">
        <li>
          <a href="#">查询功能</a>
          <ul class="submenu">
            <li><a onclick="showIpLookup()">IP查询</a></li>
            <li><a onclick="showPlaceholder('路由信息查询')">路由信息查询</a></li>
            <li><a onclick="showPlaceholder('网络拓扑')">网络拓扑</a></li>
          </ul>
        </li>
        <li>
          <a href="#">AWS</a>
          <ul class="submenu">
            <li><a onclick="loadDataTable('/api/aws/ec2/','EC2实例信息','ec2-table', ec2Columns)">主机信息</a></li>
            <li><a onclick="loadDataTable('/api/aws/vpc/','VPC信息','vpc-table', vpcColumns)">VPC信息</a></li>
            <li><a onclick="loadDataTable('/api/aws/route-table/','路由表信息','route-table', routeColumns)">路由表信息</a></li>
            <li><a onclick="loadDataTable('/api/aws/security-group/','安全组信息','sg-table', sgColumns)">安全组信息</a></li>
            <li><a onclick="loadDataTable('/api/aws/eip/','EIP信息','eip-table', eipColumns)">EIP 信息</a></li>
            <li><a onclick="loadDataTable('/api/aws/vpc-endpoint/', 'VPC Endpoint 信息', 'vpc-endpoint-table', vpcEndpointColumns)">VPC Endpoint 信息</a></li>
            <li><a onclick="loadDataTable('/api/aws/route53/','Route53','route53-table', route53Columns)">Route53 信息</a></li>
            <li>
              <a href="#">Load balancing</a>
              <ul class="submenu">
                <li><a onclick="loadDataTable('/api/aws/load-balancers/','Load balancers','lb-table', awslbColumns)">Load Balancers</a></li>
                <li><a onclick="loadDataTable('/api/aws/listener-rules/','Listener Rules','lr-table', awslrColumns)">Listener Rules</a></li>
                <li><a href="#" id="menu-target-groups">Target Groups</a></li>
{#              <li><a onclick="loadTargetGroups()">Target Groups</a></li>#}
{#              <li><a onclick="loadDataTable('/api/aws/target-groups/','Target Groups','tg-table', awstgColumns)">Target Groups</a></li>#}
              </ul>
            </li>
          </ul>
        </li>
        <li>
          <a href="#">Azure</a>
          <ul class="submenu">
            <li><a onclick="showPlaceholder('Azure主机信息')">主机信息</a></li>
            <li><a onclick="showPlaceholder('vnet信息')">vnet信息</a></li>
            <li><a onclick="showPlaceholder('Azure路由表信息')">路由表信息</a></li>
            <li><a onclick="showPlaceholder('Azure安全组信息')">安全组信息</a></li>
          </ul>
        </li>
        <li><a onclick="showTasks()">任务列表</a></li>
      </ul>
    </div>

    <!-- 右侧内容区 -->
    <div class="content" id="main-content">
      <div id="welcome-section">
        <h1>欢迎来到 Network Home</h1>
        <p>请选择左侧菜单进行操作。</p>
      </div>

        <!-- Target Groups 容器 -->
      <div id="target-groups-container" style="display: none;">
            <h2>Target Groups</h2>
            <table id="tg-table" class="tg-table">
              <thead>
                <tr>
                  <th>Target Group Name</th>
                  <th>Protocol</th>
                  <th>Port</th>
                  <th>Target Type</th>
                  <th>VPC ID</th>
                  <th>Load Balancer</th>
                </tr>
              </thead>
              <tbody id="tg-table-body">
                <!-- JS 动态填充 -->
              </tbody>
            </table>
            <div id="pagination-container" style="margin-top: 10px; text-align: center;"></div>
      </div>
      <!-- 用于显示选中 TG 的详情 -->
      <div id="tg-detail-container" style="margin-top: 20px; border: 1px solid #ccc; padding: 10px; display:none;">
      </div>
    </div>
  </div>

  <input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}">
  {% include 'edit-modal.html' %}
  <script>
    const LOGOUT_URL = "{% url 'logout' %}";
  </script>
  <script src="{% static 'js/common.js' %}"></script>
  <script src="{% static 'js/tableLoader.js' %}"></script>
  <script src="{% static 'js/route53.js' %}"></script>
  <script src="{% static 'js/ipLookup.js' %}"></script>
  <script src="{% static 'js/edit-modal.js' %}"></script>
  <script src="{% static 'js/logout_timer.js' %}" defer></script>

  <!-- 重点：引入 target-groups.js -->
  <script src="{% static 'js/target-groups.js' %}"></script>
  <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
</body>
</html>
